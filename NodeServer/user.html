<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>user Test</title>
        <link rel="stylesheet" type="text/css" href="css/reset.css">
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
    </head>

    <body>
        <div id="Experiment_Section" class="section">
            <button id="Exp_New_B" class="threeAcross">New Experiment</button>
            <button id="Exp_End_B" class="threeAcross">End Experiment</button>
            <button id="Debug_B" class="threeAcross">Debug Toggle</button>
        </div>
        <div id="Live_Section">

        </div>
        <div id="Mode_Section" class="section">
            <button id="Mode_Avatar_B" class="threeAcross">Avatar</button>
            <button id="Mode_BB_B" class="threeAcross">Bounding Box</button>
            <button id="Mode_Hybrid_B" class="threeAcross">Hybrid</button>
        </div>
        <div id="Trial_Section" class="section">
            <button id="Trial_New_B" class="oneAcross">New Trial</button>
        </section>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            //!!want to load in JSOn object representing data we constantly send
            function getUserObj(socketID, x, y, z, r, g, b, message)
            {
                let userObj = {};
                userObj.socketID = socketID;
                userObj.x = x;
                userObj.y = y;
                userObj.z = z;
                userObj.r = r;
                userObj.g = g;
                userObj.b = b;
                userObj.message = message;
                return userObj;
            }

            let userID = "";
            let socket = io();
            //var socket = io("/namespace_display");
            //socket.connect("http://localhost:8080");

            socket.on("connect", function(data) {
                socket.emit("newUser");
            });

            socket.on("usersData", (data) => {
                //this data will be in array form ...
                console.log("user:message: " + JSON.stringify(data));
            });

            //when we receive a unique ID. We will use this to send data to the server (and identify ourselves)
            socket.on( "givenID", (data) => {
                userID = data.socketID;
                console.log( "id received: " + userID );
            });

            //doc ready, let's send our movement
            $(document).ready(function () {
              $(document).mousemove( (event) => {  
                  if ( userID !== "" ) {
                    let dataObj = getUserObj(userID, event.pageX, 0.0, event.pageY, 0, 0, 0, ""); ; //{ id:userID, num1:event.pageX, num2:event.pageY, num3:0, message:""};
                    console.log("mousemove: " + dataObj);
                    socket.emit("positionUpdate", dataObj);
                  }
              });
            });

        </script>
    </body>
</html>
